
<form class=" d-flex flex-column row-gap-3 w-75 mx-auto needs-validation" novalidate  onsubmit="gameForm(event,'{{game.id}}')">
    {{#game.id}}
    <input type="hidden" value="{{game.id}}" name ="id">
    {{/game.id}}
    <div>
        <label for="inputTitle" class="form-label">Title</label>
        <input type="text" class="form-control" id="inputTitle" placeholder="e.g. Hollow Knight: Silksong" name="title"
            value="{{game.title}}" pattern="^[A-ZÁÉÍÓÚ].*" required>
        <div class="invalid-feedback">Please enter a title that begins with a capital letter.</div>
    </div>

    <div>
        <label for="inputDescription" class="form-label">Description</label>
        <textarea class="form-control" id="inputDescription" placeholder="Briefly describe the videogame..." rows="4"
            name="description" minlength="1" maxlength="400" required>{{game.description}}</textarea>
        <div class="invalid-feedback">Please add a description.</div>
    </div>

    <div>
        <legend>Genres</legend>
        <div id="genreSelect">
            {{#GENRES}}
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="{{name}}" id="Genre{{name}}" name="genres"
                    {{#checked}}checked{{/checked}}>
                <label class="form-check-label" for="Genre{{name}}">
                    {{name}}
                </label>
            </div>
            {{/GENRES}}
        </div>
        <input type="hidden" id="genresRequired" required>
        <div id="genreError" class="invalid-feedback">Please select at least one genre</div>
    </div>

    <div>
        <legend>Platforms</legend>
        <div id="platformSelect">
            {{#PLATFORMS}}
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="{{name}}" id="Platform{{name}}" name="platforms"
                    {{#checked}}checked{{/checked}}>
                <label class="form-check-label" for="Platform{{name}}">
                    {{name}}
                </label>
            </div>
            {{/PLATFORMS}}
        </div>
        <div id="platformError" class="invalid-feedback">Please select at least one platform</div>
    </div>

    <div>
        <label for="inputDate">Release Date</label>
        <input type="date" class="form-control" id="inputDate" required name="release_date"
            value="{{game.release_date}}" />
        <div class="invalid-feedback">Please enter a Release Date</div>
    </div>

    <div>
        <label for="inputDeveloper" class="form-label">Developer</label>
        <input type="text" class="form-control" id="inputDeveloper" placeholder="e.g. Team Cherry" required
            name="developer" value="{{game.developer}}">
        <div class="invalid-feedback">Please enter a developer.</div>
    </div>

    <div>
        <label for="PEGISelector" class="form-label">PEGI Rating</label>
<select class="form-select" id="PEGISelector" required name="pegi_rating">
    {{#PEGI}}
    <option value="{{value}}" {{#selected}}selected{{/selected}}>{{value}}</option>
    {{/PEGI}}
</select>
    </div>

    <div>
        <div class="col-md-4 col-12 mb-3 mb-md-0" id="coverPreviewWrapper">
            {{#game.cover_image}}
            <img id="coverPreview" src="{{game.cover_image}}" alt="Cover of {{title}}" class="img-fluid rounded shadow"/>
            {{/game.cover_image}}
            {{^game.cover_image}}
            <img id="coverPreview" src="" alt="Cover preview" class="img-fluid rounded shadow d-none" />
            {{/game.cover_image}}
        </div>

        <label for="inputImage" class="form-label">Upload Cover Image</label>
        <div id="drop-zone" class="p-4 text-center border rounded mb-2" style="border-style: dashed; cursor: pointer;">
            <p class="mb-2">Drag & Drop your image here or click to select</p>
            <input class="form-control d-none" type="file" id="inputImage" name="cover_image" accept="image/*"
                value="{{game.cover_image}}" onchange="handleImageOnChange(event, 'coverPreview', 'removeCover')" {{#game.cover_image}} keep {{/game.cover_image}}>
            <button type="button" class="btn btn-secondary btn-sm" onclick="document.getElementById('inputImage').click()">Select File</button>
        </div>
        <button type="button" class="btn btn-danger mt-2" id="removeCover" onclick="removeCoverImage('inputImage', 'coverPreview')" {{^game.cover_image}}disabled{{/game.cover_image}}>Remove Image</button>
        <div class="form-text">Accepted formats: JPG, PNG, WEBP, etc.</div>
        <div class="invalid-feedback">Please select a cover image.</div>
    </div>

    <div class="d-flex justify-content-center gap-3 mt-4 flex-wrap">
        <button type="submit" class="btn btn-primary">Save</button>
        <a href="/" class="btn btn-secondary" role="button">Cancel</a>
    </div>
</form>